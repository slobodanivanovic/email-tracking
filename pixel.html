<!DOCTYPE html>
<html>
<head>
    <title>Email Tracking</title>
    <meta charset="utf-8">
</head>
<body>
<script>
// Obtener parámetros de la URL
const params = new URLSearchParams(window.location.search);
const emailId = params.get('email_id');

if (emailId) {
    // Método alternativo: crear form invisible y enviarlo
    const form = document.createElement('form');
    form.method = 'POST';
    form.action = 'https://forms.office.com/Pages/ResponsePage.aspx?id=dGla839g1EeC1_8x19xTpZfKHpf9wDNIqQQsoVloP0ZUQTQwTFI2MlNaN0xRR0xHTktTUjdKUDI3Uy4u';
    form.target = '_blank';
    form.style.display = 'none';
    
    // Agregar campos como inputs ocultos
    const fields = [
        {name: 'r4919357d234f4b028882b429956184a0', value: emailId},
        {name: 'r9655b868b5d84c87b124ddf446317853', value: 'Open'},
        {name: 'r0019dad38b3e49188987bb79bfc06467', value: navigator.userAgent}
    ];
    
    fields.forEach(field => {
        const input = document.createElement('input');
        input.type = 'hidden';
        input.name = field.name;
        input.value = field.value;
        form.appendChild(input);
    });
    
    document.body.appendChild(form);
    
    console.log('Submitting form to Microsoft Forms...');
    form.submit();
    
    // Limpiar después de enviar
    setTimeout(() => {
        document.body.removeChild(form);
    }, 1000);
    }).catch(err => {
        // Error silencioso - no afecta al usuario
        console.log('Tracking error:', err);
    });
}

// Mostrar pixel invisible (1x1 transparent)
document.body.innerHTML = '<img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" width="1" height="1" style="display:none;">';
</script>
</body>
</html>